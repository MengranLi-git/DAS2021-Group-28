ggplot(pig.weights, aes(x=num.weeks, y=weight))+ geom_point(alpha=0.5, color="#08589e") +
xlab("week number") +
geom_path(data=predictions, aes(x=x, y=p1), col="#7bccc4", linetype=4) +
geom_path(data=predictions, aes(x=x, y=p2), col="#a8ddb5", linetype=5)
library(faraway)
data(pulp)
head(pulp)
library(lme4)
mmod <- lmer(bright ~ 1+(1|operator), data=pulp)
summary(mmod)
ggplot(pulp, aes(x=bright, y=operator))+ geom_point(alpha=0.5, color="#ec7014") +
geom_path(aes(group=operator), alpha=0.3, col="#fec44f")
lmod <- lm(bright ~ operator, data=pulp)
summary(lmod)
anova(lmod)
round(confint(mmod,method="boot",oldNames=FALSE),3)
# Diagnostic plots:
par(mfrow=c(1,2))
qqnorm(resid(mmod), main="")
qqline(resid(mmod))
plot(fitted(mmod), resid(mmod), xlab="Fitted", ylab="Residuals")
abline(0,0)
bites <- read.csv(url("http://www.stats.gla.ac.uk/~tereza/rp/bites.csv"))
head(bites)
bites$location <- as.factor(bites$location)
ggplot(bites, aes(x=score, y=product))+
geom_point(aes(shape = location, color=location)) +
geom_path(aes(group=product, color=location)) +
facet_wrap(~location)
bm1 <- lmer(score ~ product+(1|location)+(1|product:location), data=bites)
summary(bm1)
confint(bm1, oldNames=FALSE)
gpa_multil<-lmer(gpa ~ occasion + sex + highgpa + (1+occasion|student), data=gpa)
summary(gpa_multil)
round(confint(gpa_multil, oldNames=FALSE),3)
library(mlmRev)
install.packages("mlmeRev")
library(mlmRev)
install.packages("mlmRev")
library(mlmRev)
head(Contraception)
library(lattice)
lattice.options(default.theme = function() standard.theme())
print(xyplot(ifelse(use == "Y", 1, 0) ~ age|urban, Contraception,
groups = livch, type = c("g", "smooth"),
auto.key = list(space = "top", points = FALSE,
lines = TRUE, columns = 4),
ylab = "Proportion", xlab = "Centered age"))
Contraception <- within(Contraception,
ch <- factor(livch != 0, labels = c("N", "Y")))
head(Contraception)
print(xyplot(ifelse(use == "Y", 1, 0) ~ age|urban, Contraception,
groups = ch, type = c("g", "smooth"),
auto.key = list(space = "top", points = FALSE,
lines = TRUE, columns = 2),
ylab = "Proportion", xlab = "Centered age"))
glm1 <- glm(use ~ 1 + urban + age*ch + I(age^2), data=Contraception,
family=binomial)
summary(glm1)
within(Contraception,
ch <- factor(livch != 0, labels = c("N", "Y")))
factor(livch != 0, labels = c("N", "Y")))
factor(livch != 0, labels = c("N", "Y"))
ch <- factor(livch != 0, labels = c("N", "Y"))
head(Contraception)
livch
factor(Contraception$livch != 0, labels = c("N", "Y"))
head(Contraception)
head(epilepsy)
ggplot(tdata, aes(x=week, y=sqrt(seizures), color=factor(treat), group=id)) +
geom_point(alpha=0.5) + geom_path(aes(linetype=factor(treat))) +
scale_color_manual(values=c("#fd8d3c", "#41ab5d"),
labels=c("Placebo","Treatment"), name="Treatment") +
scale_linetype_manual(values=c(1,6),
labels=c("Placebo", "Treatment"), name="Treatment")
tdata <- data.frame(epilepsy[epilepsy$expind==1,], week=rep(seq(2,8, by=2), 59))
ggplot(tdata, aes(x=week, y=sqrt(seizures), color=factor(treat), group=id)) +
geom_point(alpha=0.5) + geom_path(aes(linetype=factor(treat))) +
scale_color_manual(values=c("#fd8d3c", "#41ab5d"),
labels=c("Placebo","Treatment"), name="Treatment") +
scale_linetype_manual(values=c(1,6),
labels=c("Placebo", "Treatment"), name="Treatment")
# mean seizures (per week) during experiment
y <- matrix( epilepsy$seizures, nrow=5)
exp <- sqrt( apply(y[-1,], 2, mean)/2)
# mean seizures (per week) during baseline period
bas <- sqrt(epilepsy$seizures[epilepsy$expind==0]/8)
d <- data.frame(exp, bas, t=epilepsy$treat[5*(1:59)]+2)
ggplot(d, aes(x=bas, y=exp, color=factor(t))) + geom_point(alpha=0.8) +
scale_colour_manual(values=c("#fd8d3c", "#41ab5d"),
labels=c("Placebo","Treatment"), name="Treatment") +
xlab("sqrt(Baseline)") + ylab("sqrt(Experiment)") +
geom_abline(slope=1, intercept=0)
y
(y[-1,]
library(gee)
library(gee)
install.packages("gee")
library(gee)
g1 <- gee(seizures ~ offset(log(timeadj))+expind+treat+I(expind*treat), id,
family=poisson, corstr="independence", data=epilepsy, subset=(id!=49))
summary(g1)
epilepsy$id
g2 <- gee(seizures ~ offset(log(timeadj))+expind+treat+I(expind*treat), id,
family=poisson, corstr="exchangeable", data=epilepsy, subset=(id!=49))
summary(g2)
g3 <- gee(seizures ~ offset(log(timeadj))+expind+treat+I(expind*treat), id,
family=poisson, corstr="AR-M", Mv=1, data=epilepsy, subset=(id!=49))
summary(g3)
g4 <- gee(seizures ~ offset(log(timeadj))+expind+treat+I(expind*treat), id,
family=poisson, corstr="unstructured", data=epilepsy, subset=(id!=49))
summary(g4)
library(faraway)
head(ohio)
fit.un <- gee(resp~age*smoke, id=id, family=binomial, corstr="unstructured", data=ohio)
summary(fit.un)
fit.un2 <- gee(resp~age+smoke, id=id, family=binomial, corstr="unstructured", data=ohio)
summary(fit.un2)
fit.ex2 <- gee(resp ~ age+smoke, id=id, family=binomial, corstr="exchangeable", data=ohio)
summary(fit.ex2)
fit.glmm1 <- glmer(resp ~ age + smoke + (1|id), family=binomial, data=ohio)
summary(fit.glmm1)
knitr::opts_chunk$set(echo = FALSE, eval = TRUE, warning = FALSE, message = FALSE, comment = NA, fig.pos = 'H')
library(tidyverse)
library(tidymodels)
library(GGally)
library(car)
library(sjPlot)
library(skimr)
library(kableExtra)
Data <- read.csv("dataset28.csv")
knitr::opts_chunk$set(echo = FALSE, eval = TRUE, warning = FALSE, message = FALSE, comment = NA, fig.pos = 'H')
Data <- read.csv("data/Group_28.csv")
Data <- Data %>% spread(variable, value)
Data$DateCode <- as.factor(Data$DateCode)
setwd("C:\\Users\\Aishwin Tikku\\Documents\\GitHub\\DAS2021-Group-28")
Data <- read.csv("dataset28.csv")
View(Data)
View(Data)
View(Data)
setwd("C:\\Users\\Aishwin Tikku\\Documents\\GitHub\\DAS2021-Group-28")
Data <- read.csv("dataset28.csv")
#### data processing ####
Data <- Data[, -1]
glimpse(Data)
summary(Data)
Data$country <- as.factor(Data$country)
Data$province <- as.factor(Data$province)
Data$title <- as.factor(Data$title)
Data$variety <- as.factor(Data$variety)
Data$winery <- as.factor(Data$winery)
summary(Data)
setwd("C:\\Users\\Aishwin Tikku\\Documents\\GitHub\\DAS2021-Group-28")
Data <- read.csv("dataset28.csv")
```{ r echo = TRUE, eval = TRUE, warning = FALSE, message = FALSE}
Data <- Data[, -1]
glimpse(Data)
summary(Data)
Data$country <- as.factor(Data$country)
Data$province <- as.factor(Data$province)
Data$title <- as.factor(Data$title)
Data$variety <- as.factor(Data$variety)
Data$winery <- as.factor(Data$winery)
``
```{ r, echo = TRUE, eval = TRUE, warning = FALSE, message = FALSE}
Data <- Data[, -1]
glimpse(Data)
summary(Data)
Data$country <- as.factor(Data$country)
Data$province <- as.factor(Data$province)
Data$title <- as.factor(Data$title)
Data$variety <- as.factor(Data$variety)
Data$winery <- as.factor(Data$winery)
```
setwd("C:\\Users\\Aishwin Tikku\\Documents\\GitHub\\DAS2021-Group-28")
Data1 <- read.csv("dataset28.csv")
View(Data1)
summary(Data)
Data <- Data[, -1]
glimpse(Data)
summary(Data)
Data$country <- as.factor(Data$country)
setwd("C:\\Users\\Aishwin Tikku\\Documents\\GitHub\\DAS2021-Group-28")
Data <- read.csv("dataset28.csv")
View(Data)
Data <- Data[, -1]
glimpse(Data)
summary(Data)
Data$country <- as.factor(Data$country)
Data$province <- as.factor(Data$province)
Data$title <- as.factor(Data$title)
Data$variety <- as.factor(Data$variety)
Data$winery <- as.factor(Data$winery)
Data$country <- as.factor(Data$country)
Data$province <- as.factor(Data$province)
Data$title <- as.factor(Data$title)
Data$variety <- as.factor(Data$variety)
Data$winery <- as.factor(Data$winery)
summary(Data)
summary(Data)
library(knitr)
Data <- Data[, -1]
glimpse(Data)
kable(summary(Data), caption = " Summary Table of Wine DAtaset")
Data$country <- as.factor(Data$country)
Data <- Data[, -1]
glimpse(Data)
kable(summary(Data), caption = " Summary Table of Wine DAtaset")
Data$country <- as.factor(Data$country)
library(knitr)
library(knitr)
``` {r echo = FALSE, eval = TRUE, warning = FALSE, message = FALSE}
setwd("C:\\Users\\Aishwin Tikku\\Documents\\GitHub\\DAS2021-Group-28")
Data <- read.csv("dataset28.csv")
Data <- Data[, -1]
glimpse(Data)
kable(summary(Data), caption = " Summary Table of Wine DAtaset")
Data$country <- as.factor(Data$country)
Data$province <- as.factor(Data$province)
Data$title <- as.factor(Data$title)
Data$variety <- as.factor(Data$variety)
Data$winery <- as.factor(Data$winery)
summary(Data)
View(Data)
View(Data)
View(Data)
# Group by points, those greater than 90 are pass, others are fail
Data <- Data %>% mutate(score = ifelse(points > 90, "Pass", "Fail"))
View(Data)
Data$score <- as.factor(Data$score)
#### descriptive statistics ####
Data[, c(2, 3)] %>%
gather(key = "variable", value = "value") %>%
ggplot() +
geom_histogram(aes(x = value), fill = "#80C687", color = "#80C687", alpha = 0.8) +
facet_wrap(~variable, scales = "free")
#### descriptive statistics ####
Data[, c(2, 3)] %>%
gather(key = "variable", value = "value") %>%
ggplot() +
geom_histogram(aes(x = value), fill = "#80C687", color = "#80C687", alpha = 0.8) +
facet_wrap(~variable, scales = "free")
gather(key = "variable", value = "value")
#### descriptive statistics ####
Data[, c(2, 3)] %>%
gather(key = "variable", value = "value") %>%
ggplot() +
geom_histogram(aes(x = value), fill = "#80C687", color = "#80C687", alpha = 0.8) +
facet_wrap(~variable, scales = "free")
#### descriptive statistics ####
Data[, c(2, 3)] %>%
gather(key = "variable", value = "value") %>%
ggplot() +
geom_histogram(aes(x = value), fill = "#80C687", color = "#80C687", alpha = 0.8) +
facet_wrap(~variable, scales = "free")
ggplot(data = Data) +
geom_boxplot(aes(points, country))
count <- table(Data$country, Data$score)
prop.table(count, margin = 1)
table(Data$country, Data$score)
m <- matrix(1:4,2)
m
prop.table(m)
prop.table(m,1)
prop.table(m,margin =1)
count <- table(Data$country, Data$score)
p <- prop.table(count, margin = 1)
kable(p, caption = "Cross Table of Country & Score")
View(Data)
View(Data)
View(Data)
#### descriptive statistics ####
Data[, c(2, 3)] %>%
gather(key = "variable", value = "value") %>%
ggplot() +
geom_histogram(aes(x = value), fill = "#80C687", color = "#80C687", alpha = 0.8) +
facet_wrap(~variable, scales = "free")
library(ggplot2)
Data <- Data[, -1]
Data$country <- as.factor(Data$country)
setwd("C:\\Users\\Aishwin Tikku\\Documents\\GitHub\\DAS2021-Group-28")
Data <- read.csv("dataset28.csv")
View(Data)
Data <- Data[, -1]
Data$country <- as.factor(Data$country)
Data$province <- as.factor(Data$province)
Data$title <- as.factor(Data$title)
Data$variety <- as.factor(Data$variety)
Data$winery <- as.factor(Data$winery)
# Group by points, those greater than 90 are pass, others are fail
Data <- Data %>% mutate(score = ifelse(points > 90, "Pass", "Fail"))
Data$score <- as.factor(Data$score)
`
``
```{r his, fig.width=6, fig.height=4, fig.align='center',echo = FALSE, eval = TRUE, warning = TRUE, message = FALSE, fig.cap="\\label{fig:hist} Histogram of Price and Points"}
Data <- Data[, -1]
Data$country <- as.factor(Data$country)
# chi square test
chisq.test(Data$country, Data$score)
Data <- read.csv("dataset28.csv")
#### data processing ####
Data <- Data[, -1]
glimpse(Data)
summary(Data)
Data$country <- as.factor(Data$country)
Data$province <- as.factor(Data$province)
Data$title <- as.factor(Data$title)
Data$variety <- as.factor(Data$variety)
Data$winery <- as.factor(Data$winery)
# Group by points, those greater than 90 are pass, others are fail
Data <- Data %>% mutate(score = ifelse(points > 90, "Pass", "Fail"))
Data$score <- as.factor(Data$score)
#### descriptive statistics ####
Data[, c(2, 3)] %>%
gather(key = "variable", value = "value") %>%
ggplot() +
geom_histogram(aes(x = value), fill = "#80C687", color = "#80C687", alpha = 0.8) +
facet_wrap(~variable, scales = "free")
# boxplot of points by country
ggplot(data = Data) +
geom_boxplot(aes(points, country))
# cross-table of country and score
count <- table(Data$country, Data$score)
prop.table(count, margin = 1)
# chi square test
chisq.test(Data$country, Data$score)
# chi square test
a <- chisq.test(Data$country, Data$score)
print_chi2(a)
count <- table(Data$country, Data$score)
prop.table(count, margin = 1)%>%
kable(caption ="Cross Table of Country and Score")
# chi square test
chisq.test(Data$country, Data$score)
# density plot by score
ggplot(data = Data) +
geom_density(aes(price, group = score, fill = score))
ggplot(data = Data) +
geom_density(aes(price, group = score, fill = score))
$$\widehat{\mbox{Height}} = \widehat{\alpha} + \widehat{\beta}_{\mbox{Fwd}} \cdot \mathbb{I}_{\mbox{Fwd}}(x)$$
fit <- glm(score ~ price + country,
data = Data,
family = binomial(link = "logit"))
fit %>% summary()
knitr::opts_chunk$set(echo = FALSE, eval = TRUE, warning = FALSE, message = FALSE, comment = NA, fig.pos = 'H')
options(digits = 4)
library(tidyverse)
library(ggplot2)
library(tidymodels)
library(GGally)
library(car)
library(sjPlot)
library(skimr)
library(kableExtra)
library(knitr)
library(janitor)
library(tidyverse)
library(ggplot2)
library(tidymodels)
library(GGally)
library(car)
library(sjPlot)
library(skimr)
library(kableExtra)
library(knitr)
library(janitor)
setwd("C:\\Users\\Aishwin Tikku\\Documents\\GitHub\\DAS2021-Group-28")
Data <- Data[, -1]
Data$country <- as.factor(Data$country)
Data <- read.csv("dataset28.csv")
knitr::opts_chunk$set(echo = FALSE, eval = TRUE, warning = FALSE, message = FALSE, comment = NA, fig.pos = 'H')
options(digits = 4)
library(tidyverse)
library(ggplot2)
library(tidymodels)
library(GGally)
library(car)
library(sjPlot)
library(skimr)
library(kableExtra)
library(knitr)
library(janitor)
Data <- read.csv("dataset28.csv")
setwd("~/GitHub/DAS2021-Group-28")
setwd("C:\Users\Derek\OneDrive - University of Glasgow\Desktop\RStudio\Data Analysis Skills\Group28_report")
setwd("C:\\Users\\Derek\\OneDrive - University of Glasgow\\Desktop\\RStudio\\Data Analysis Skills\\Group28_report")
Data <- read.csv("dataset28.csv")
knitr::opts_chunk$set(echo = FALSE, eval = TRUE, warning = FALSE, message = FALSE, comment = NA, fig.pos = 'H')
options(digits = 4)
#### glm model ####
fit <- glm(score ~ price + country,
data = Data,
family = binomial(link = "logit"))
knitr::opts_chunk$set(echo = FALSE, eval = TRUE, warning = FALSE, message = FALSE, comment = NA, fig.pos = 'H')
options(digits = 4)
library(tidyverse)
library(ggplot2)
library(tidymodels)
library(GGally)
library(car)
library(sjPlot)
library(skimr)
library(kableExtra)
library(knitr)
library(janitor)
Data <- read.csv("dataset28.csv")
Data <- Data[, -1]
Data$country <- as.factor(Data$country)
Data$province <- as.factor(Data$province)
Data$title <- as.factor(Data$title)
Data$variety <- as.factor(Data$variety)
Data$winery <- as.factor(Data$winery)
# Group by points, those greater than 90 are pass, others are fail
Data <- Data %>% mutate(score = ifelse(points > 90, "Pass", "Fail"))
Data$score <- as.factor(Data$score)
#### descriptive statistics ####
Data[, c(2, 3)] %>%
gather(key = "variable", value = "value") %>%
ggplot() +
geom_histogram(aes(x = value), fill = "#80C687", color = "#80C687", alpha = 0.8) +
facet_wrap(~variable, scales = "free")
ggplot(data = Data) +
geom_boxplot(aes(points, country))
Data %>%
tabyl(country,score)%>%
adorn_percentages()%>%
adorn_pct_formatting()%>%
adorn_ns()
# chi square test
chisq.test(Data$country, Data$score)
ggplot(data = Data) +
geom_density(aes(price, group = score, fill = score))
Data %>%
tabyl(country,score)%>%
adorn_percentages()%>%
adorn_pct_formatting()%>%
adorn_ns()
#### glm model ####
fit <- glm(score ~ price + country,
data = Data,
family = binomial(link = "logit"))
#### glm model ####
fit <- glm(score ~ price + country,
data = Data,
family = binomial(link = "logit"))
s <- fit %>% summary()
kable(s$coefficients, caption = "Summary Statistics of GLM Model")
NewZealand <- Data %>% filter(country == "New Zealand")
nz <- glm(score ~ price + province + variety,
data = NewZealand,
family = binomial(link = "logit"))
nzland <- nz %>%
summary()
kable(round(nzland$coefficients,4), caption = "GLM Model for New Zealand")
knitr::opts_chunk$set(echo = TRUE, eval = TRUE, warning = FALSE, message = FALSE, comment = NA, fig.pos = 'H')
options(digits = 4)
# read data
Data <- read.csv("dataset28.csv")
Data <- Data[, -1]
View(Data)
# read data
Data <- read.csv("dataset28.csv")
?read.csv
# summary of numbers of observation
t <- as.matrix(table(Data$variety))
t
Data$variety <- as.vector(Data$variety)
Data$variety[which(Data$variety %in% row.names(t)[t<11])] = "other"
Data$variety <- as.factor(Data$variety)
# summary of numbers of observation
t <- as.matrix(table(Data$variety))
t %>% kbl()
# library packages
library(tidyverse)
library(ggplot2)
library(tidymodels)
library(GGally)
library(car)
library(sjPlot)
library(skimr)
library(kableExtra)
library(janitor)
# summary of numbers of observation
t <- as.matrix(table(Data$variety))
t %>% kbl()
Data$variety <- as.vector(Data$variety)
Data$variety[which(Data$variety %in% row.names(t)[t<11])] = "other"
Data$variety <- as.factor(Data$variety)
# summary of numbers of observations
t <- as.matrix(table(Data$variety))
t %>%
kbl(caption = 'Numbers of observations of each Wine Variety', booktabs = T)%>%
kable_styling(latex_options = "HOLD_position")
Data$variety <- as.vector(Data$variety)
Data$variety[which(Data$variety %in% row.names(t)[t<11])] = "other"
Data$variety <- as.factor(Data$variety)
# summary of numbers of observations
t <- as.matrix(table(Data$variety))
head(t) %>%
kbl(caption = 'Numbers of observations of each Wine Variety', booktabs = T)%>%
kable_styling(latex_options = "HOLD_position")
Data$variety <- as.vector(Data$variety)
Data$variety[which(Data$variety %in% row.names(t)[t<11])] = "other"
Data$variety <- as.factor(Data$variety)
# summary of numbers of observations
t <- as.matrix(table(Data$variety))
head(t) %>%
kbl(caption = 'Numbers of observations of each Wine Variety (first six Wine Varieties)', booktabs = T)%>%
kable_styling(latex_options = "HOLD_position")
Data$variety <- as.vector(Data$variety)
Data$variety[which(Data$variety %in% row.names(t)[t<11])] = "other"
Data$variety <- as.factor(Data$variety)
