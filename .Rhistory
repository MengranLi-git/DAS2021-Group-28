# setwd("~/Desktop/Data Analysis Skills/Group work 2/Datasets-20210710")
Data <- read.csv("dataset28.csv")
# The whole data set has 7 factors and 2000 observations.
# The explanatory variables are:
# country – Country of origin
# price – The cost for a bottle of wine
# province – The province or state the wine is from
# title – The title of the wine review
# variety – The type of grape
# winery – The winery that made the wine
# the response variable y is points – The number of points awarded for the wine on a scale of 1-100 (although reviewsare only posted for ratings 80 and above)
#### data processing ####
Data <- Data[, -1]
glimpse(Data)
summary(Data)
Data$country <- as.factor(Data$country)
Data$province <- as.factor(Data$province)
Data$title <- as.factor(Data$title)
Data$variety <- as.factor(Data$variety)
Data$winery <- as.factor(Data$winery)
# Group by points, those greater than 90 are pass, others are fail
Data <- Data %>% mutate(score = ifelse(points > 90, "Pass", "Fail"))
Data$score <- as.factor(Data$score)
#### descriptive statistics ####
Data[, c(2, 3)] %>%
gather(key = "variable", value = "value") %>%
ggplot() +
geom_histogram(aes(x = value), fill = "#80C687", color = "#80C687", alpha = 0.8) +
facet_wrap(~variable, scales = "free")
# boxplot of points by country
ggplot(data = Data) +
geom_boxplot(aes(points, country))
# cross-table of country and score
count <- table(Data$country, Data$score)
prop.table(count, margin = 1)
# chi square test
chisq.test(Data$country, Data$score)
# density plot by score
ggplot(data = Data) +
geom_density(aes(price, group = score, fill = score))
#### glm model ####
fit <- glm(score ~ price + country,
data = Data,
family = binomial(link = "logit"))
fit %>% summary()
# NewZealand and Italy are significantly different from others
NewZealand <- Data %>% filter(country == "New Zealand")
Data %>% mutate(
kind = case_when(
country == "New Zealand" ~ "New Zealand",
country == "logit" ~ "logit",
!country %in% c("New Zealand", "logit") ~ "others"
)
)
newdata <- Data %>% mutate(
kind = case_when(
country == "New Zealand" ~ "New Zealand",
country == "logit" ~ "logit",
!country %in% c("New Zealand", "logit") ~ "others"
)
)
newdata <- Data %>% mutate(
kind = case_when(
country == "New Zealand" ~ "New Zealand",
country == "logit" ~ "logit",
!country %in% c("New Zealand", "logit") ~ "others"
)
)
fit2 <- glm(score ~ price + kind,
data = newdata,
family = binomial(link = "logit"))
glance(fit2)
glm(score ~ price + kind + province,
data = newdata,
family = binomial(link = "logit"))
library(janitor)
Data %>%
tabyl(country,score)%>%
adorn_percentages()%>%
adorn_pct_formatting()%>%
adorn_ns()
Data %>%
tabyl(province,score)%>%
adorn_percentages()%>%
adorn_pct_formatting()%>%
adorn_ns()
chisq.test(Data$province, Data$score)
summary(table(Data$province, Data$score))
table(Data$province, Data$score)
table(Data$province)
t <- table(Data$province)
summary(t)
t <- as.matrix(t)
t
t <- as.matrix(table(Data$province))
summary(t)
boxplot(t)
t[t>10]
newdata$location[t>10] == much
newdata$location[t>10] = "much"
newdata$location = NA
newdata$location[t>10] = "much"
newdata$location[t<2] = "less"
newdata$location[t<= 10 & t>= 2] = "normal"
View(newdata)
glm(score ~ price + kind + location,
data = newdata,
family = binomial(link = "logit"))
glm(score ~ price + kind + location,
data = newdata,
family = binomial(link = "logit")) %>%
summary()
chisq.test(Data$province, Data$score)
newdata$location = newdata$province
newdata$location[t<2] = "less"
newdata$location = as.vector(newdata$location)
newdata$location[t<2] = "less"
View(newdata)
newdata$location = as.factor(newdata$location)
summary(t)
quantile(t)
newdata$location = newdata$province
newdata$location = as.vector(newdata$location)
newdata$location[t<9] = "less"
newdata$location = as.factor(newdata$location)
glm(score ~ price + kind + location,
data = newdata,
family = binomial(link = "logit")) %>%
summary()
quantile(t)
newdata$location = newdata$province
newdata$location = as.vector(newdata$location)
newdata$location[t>10] = "much"
newdata$location = as.factor(newdata$location)
glm(score ~ price + kind + location,
data = newdata,
family = binomial(link = "logit")) %>%
summary()
newdata$location = newdata$province
newdata$location = as.vector(newdata$location)
newdata$location[t<9] = "less"
newdata$location = as.factor(newdata$location)
newdata$location = newdata$province
newdata$location = as.vector(newdata$location)
newdata$location[t<10] = "less"
newdata$location = as.factor(newdata$location)
glm(score ~ price + kind + location,
data = newdata,
family = binomial(link = "logit")) %>%
summary()
View(newdata)
newdata$location = newdata$province
newdata$location = as.vector(newdata$location)
newdata$location[t<9] = "less"
newdata$location = as.factor(newdata$location)
glm(score ~ price + kind + location,
data = newdata,
family = binomial(link = "logit")) %>%
summary()
Data %>%
tabyl(province,score)%>%
adorn_percentages()%>%
adorn_pct_formatting()%>%
adorn_ns()
glm(score ~ price + kind + location,
data = newdata,
family = binomial(link = "logit")) %>%
summary()
Data %>%
tabyl(province,score)%>%
adorn_percentages()%>%
adorn_pct_formatting()%>%
adorn_ns()
newdata$location = newdata$province
newdata$location = as.vector(newdata$location)
newdata$location[t<2] = "less"
newdata$location = as.factor(newdata$location)
glm(score ~ price + kind + location,
data = newdata,
family = binomial(link = "logit")) %>%
summary()
Data %>%
tabyl(province,score)%>%
adorn_percentages()%>%
adorn_pct_formatting()%>%
adorn_ns()
newdata$location = newdata$province
newdata$location = as.vector(newdata$location)
newdata$location[t<2] = "less"
newdata$location = as.factor(newdata$location)
newdata$location = newdata$province
newdata$location = as.vector(newdata$location)
newdata$location[t<9] = "less"
newdata$location = as.factor(newdata$location)
Data %>%
tabyl(location,score)%>%
adorn_percentages()%>%
adorn_pct_formatting()%>%
adorn_ns()
newdata %>%
tabyl(location,score)%>%
adorn_percentages()%>%
adorn_pct_formatting()%>%
adorn_ns()
newdata$location = newdata$province
newdata$location = as.vector(newdata$location)
newdata$location[t<9] = "less"
newdata$location = as.factor(newdata$location)
newdata %>%
tabyl(location,score)%>%
adorn_percentages()%>%
adorn_pct_formatting()%>%
adorn_ns()
newdata$location = newdata$province
newdata$location = as.vector(newdata$location)
newdata$location[t<9] = "less"
newdata$location = as.factor(newdata$location)
chisq.test(newdata$location, newdata$score)
table(newdata$location, newdata$score)
t <- as.matrix(table(Data$province))
t<9
col.names(t)[t<9]
col.name(t)[t<9]
colnames(t)
rownames(t)
rownames(t)[t<9]
newdata %>%
mutate(locationn = ifelse(location %in% rownames(t)[t<9], "less", location))
newdata$location = newdata$province
newdata$location = as.vector(newdata$location)
newdata %>%
mutate(location = ifelse(location %in% rownames(t)[t<9], "less", location))
newdata <- newdata %>%
mutate(location = ifelse(location %in% rownames(t)[t<9], "less", location))
newdata$location = as.factor(newdata$location)
newdata %>%
tabyl(location,score)%>%
adorn_percentages()%>%
adorn_pct_formatting()%>%
adorn_ns()
glm(score ~ price + kind + location,
data = newdata,
family = binomial(link = "logit")) %>%
summary()
newdata$location = newdata$province
newdata$location = as.vector(newdata$location)
newdata <- newdata %>%
mutate(location = ifelse(location %in% rownames(t)[t<10], "less", location))
newdata$location = as.factor(newdata$location)
newdata %>%
tabyl(location,score)%>%
adorn_percentages()%>%
adorn_pct_formatting()%>%
adorn_ns()
glm(score ~ price + kind + location,
data = newdata,
family = binomial(link = "logit")) %>%
summary()
View(newdata)
newdata$location = newdata$province
newdata$location = as.vector(newdata$location)
newdata <- newdata %>%
mutate(location = ifelse(location %in% rownames(t)[t<3], "less", location))
newdata$location = as.factor(newdata$location)
newdata %>%
tabyl(location,score)%>%
adorn_percentages()%>%
adorn_pct_formatting()%>%
adorn_ns()
glm(score ~ price + kind + location,
data = newdata,
family = binomial(link = "logit")) %>%
summary()
View(newdata)
newdata %>%
tabyl(variaty,score)%>%
adorn_percentages()%>%
adorn_pct_formatting()%>%
adorn_ns()
library(tidyverse)
library(tidymodels)
library(GGally)
library(car)
library(sjPlot)
library(janitor)
# setwd("~/Desktop/Data Analysis Skills/Group work 2/Datasets-20210710")
Data <- read.csv("dataset28.csv")
# The whole data set has 7 factors and 2000 observations.
# The explanatory variables are:
# country – Country of origin
# price – The cost for a bottle of wine
# province – The province or state the wine is from
# title – The title of the wine review
# variety – The type of grape
# winery – The winery that made the wine
# the response variable y is points – The number of points awarded for the wine on a scale of 1-100 (although reviewsare only posted for ratings 80 and above)
Data <- Data[, -1]
glimpse(Data)
summary(Data)
Data$country <- as.factor(Data$country)
Data$province <- as.factor(Data$province)
Data$title <- as.factor(Data$title)
Data$variety <- as.factor(Data$variety)
Data$winery <- as.factor(Data$winery)
Data <- Data %>% mutate(score = ifelse(points > 90, "Pass", "Fail"))
Data$score <- as.factor(Data$score)
Data %>%
tabyl(country,score)%>%
adorn_percentages()%>%
adorn_pct_formatting()%>%
adorn_ns()
chisq.test(Data$country, Data$score)
newdata %>%
tabyl(variaty,score)%>%
adorn_percentages()%>%
adorn_pct_formatting()%>%
adorn_ns()
newdata <- Data %>% mutate(
kind = case_when(
country == "New Zealand" ~ "New Zealand",
country == "logit" ~ "logit",
!country %in% c("New Zealand", "logit") ~ "others"
)
)
newdata %>%
tabyl(variaty,score)%>%
adorn_percentages()%>%
adorn_pct_formatting()%>%
adorn_ns()
newdata %>%
tabyl(variety,score)%>%
adorn_percentages()%>%
adorn_pct_formatting()%>%
adorn_ns()
t <- as.matrix(table(Data$variety))
summary(t)
quantile(t)
rownames(t)
t <- as.matrix(table(Data$variety))
newdata <- newdata %>%
mutate(variety = ifelse(variety %in% rownames(t)[t<3], "less", variety))
newdata$variety = as.factor(newdata$variety)
glm(score ~ price + kind + variety,
data = newdata,
family = binomial(link = "logit")) %>%
summary()
t <- as.matrix(table(Data$variety))
summary(t)
t
rownames(t)
rownames(t)[t<3]
newdata <- Data %>% mutate(
kind = case_when(
country == "New Zealand" ~ "New Zealand",
country == "logit" ~ "logit",
!country %in% c("New Zealand", "logit") ~ "others"
)
)
chisq.test(Data$province, Data$score)
newdata %>%
tabyl(variety,score)%>%
adorn_percentages()%>%
adorn_pct_formatting()%>%
adorn_ns()
t <- as.matrix(table(Data$variety))
summary(t)
newdata %>%
mutate(variety = ifelse(variety %in% rownames(t)[t<3], "less", variety))
variety %in% rownames(t)[t<3]
rownames(t)[t<3]
Data$variety %in% rownames(t)[t<3]
newdata$variety[t<3] = "less"
View(newdata)
newdata <- Data %>% mutate(
kind = case_when(
country == "New Zealand" ~ "New Zealand",
country == "logit" ~ "logit",
!country %in% c("New Zealand", "logit") ~ "others"
)
)
newdata$variety <- as.vector(newdata$variety)
newdata$variety[t<3] = "less"
newdata$variety <- as.factor(newdata$variety)
glm(score ~ price + kind + variety,
data = newdata,
family = binomial(link = "logit")) %>%
summary()
t <- as.matrix(table(Data$variety))
summary(t)
newdata$variety <- as.vector(newdata$variety)
newdata$variety[t<11] = "less"
newdata$variety <- as.factor(newdata$variety)
glm(score ~ price + kind + variety,
data = newdata,
family = binomial(link = "logit")) %>%
summary()
t <- as.matrix(table(Data$variety))
summary(t)
newdata$variety <- as.vector(newdata$variety)
newdata$variety[t<5] = "less"
newdata$variety <- as.factor(newdata$variety)
glm(score ~ price + kind + variety,
data = newdata,
family = binomial(link = "logit")) %>%
summary()
View(newdata)
t <- as.matrix(table(Data$variety))
summary(t)
newdata$variety <- as.vector(newdata$variety)
newdata$variety[t<20] = "less"
newdata$variety <- as.factor(newdata$variety)
glm(score ~ price + kind + variety,
data = newdata,
family = binomial(link = "logit")) %>%
summary()
newdata$variety <- as.vector(newdata$variety)
newdata$variety[t<200] = "less"
newdata$variety <- as.factor(newdata$variety)
glm(score ~ price + kind + variety,
data = newdata,
family = binomial(link = "logit")) %>%
summary()
View(newdata)
newdata %>%
tabyl(variety,score)%>%
adorn_percentages()%>%
adorn_pct_formatting()%>%
adorn_ns()
t
row.names(t)[t<200]
row.names(t)[t<2]
newdata$variety %in% row.names(t)[t<2]
newdata$variety[newdata$variety %in% row.names(t)[t<2]]
newdata$variety[which(newdata$variety %in% row.names(t)[t<2])]
which(newdata$variety %in% row.names(t)[t<2])
Data %>%
tabyl(variety,score)%>%
adorn_percentages()%>%
adorn_pct_formatting()%>%
adorn_ns()
chisq.test(Data$variety, Data$score)
t <- as.matrix(table(Data$variety))
t
[t<2]
t<2
row.names(t)[t<2]
which(newdata$variety %in% row.names(t)[t<2])
newdata$variety
newdata <- Data %>% mutate(
kind = case_when(
country == "New Zealand" ~ "New Zealand",
country == "logit" ~ "logit",
!country %in% c("New Zealand", "logit") ~ "others"
)
)
newdata$variety[which(newdata$variety %in% row.names(t)[t<2])]
newdata$variety[which(newdata$variety %in% row.names(t)[t<2])] = "less"
newdata$variety <- as.vector(newdata$variety)
newdata$variety <- as.factor(newdata$variety)
newdata <- Data %>% mutate(
kind = case_when(
country == "New Zealand" ~ "New Zealand",
country == "logit" ~ "logit",
!country %in% c("New Zealand", "logit") ~ "others"
)
)
newdata$variety <- as.vector(newdata$variety)
newdata$variety[which(newdata$variety %in% row.names(t)[t<5])] = "less"
newdata$variety <- as.factor(newdata$variety)
newdata <- Data %>% mutate(
kind = case_when(
country == "New Zealand" ~ "New Zealand",
country == "logit" ~ "logit",
!country %in% c("New Zealand", "logit") ~ "others"
)
)
newdata$variety <- as.vector(newdata$variety)
newdata$variety[which(newdata$variety %in% row.names(t)[t<10])] = "less"
newdata$variety <- as.factor(newdata$variety)
glm(score ~ price + kind + variety,
data = newdata,
family = binomial(link = "logit")) %>%
summary()
newdata <- Data %>% mutate(
kind = case_when(
country == "New Zealand" ~ "New Zealand",
country == "logit" ~ "logit",
!country %in% c("New Zealand", "logit") ~ "others"
)
)
newdata$variety <- as.vector(newdata$variety)
newdata$variety[which(newdata$variety %in% row.names(t)[t<20])] = "less"
newdata$variety <- as.factor(newdata$variety)
glm(score ~ price + kind + variety,
data = newdata,
family = binomial(link = "logit")) %>%
summary()
Data %>%
tabyl(variety,score)%>%
adorn_percentages()%>%
adorn_pct_formatting()%>%
adorn_ns()
newdata %>%
tabyl(variety,score)%>%
adorn_percentages()%>%
adorn_pct_formatting()%>%
adorn_ns()
glm(score ~ price + kind + variety,
data = newdata,
family = binomial(link = "logit")) %>%
summary()
chisq.test(newdata$variety, newdata$score)
